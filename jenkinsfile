<<<<<<< HEAD
#!/usr/bin/env groovy
pipeline {
     agent any
	stages {
		stage('Git Checkout'){
			steps {
				git 'https://github.com/madhumita-kundo/time-tracker.git'
				}
		}
		stage('compile'){
			steps {
				sh 'mvn clean compile'
				}
		}
		stage('package'){
			steps {
				sh 'mvn package'
				}
		}
		stage('clear service'){
			steps {
				sh ''' GO=$(docker service ls | grep "time-tracker" | wc -l)
				if [ $GO -ne 0 ]
 				then
   				docker service rm time-tracker
   				fi
				'''
				}
		}
		stage('docker build'){
			steps {
				sh 'docker build -t timetracker-test:${BUILD_NUMBER} .'
				}
		}
		stage('swarm service'){
			steps {
				sh 'docker service create --name time-tracker -d -p 8000:8080 timetracker-test:${BUILD_NUMBER}'
				}
		}
	}
}
=======
pipeline {
   agent any
	stages {
		stage('Git Checkout'){
			steps {
				git 'https://github.com/madhumita-kundo/Frontend-Service.git'
				}
		}
		stage('compile'){
			steps {
				sh 'mvn clean compile'
				}
		}
    		stage('test'){
			steps {
				sh 'mvn test'
				}
		}
		stage('package'){
			steps {
				sh 'mvn package'
				}
		}
		stage('publish artifacts to udeploy'){
			  step([$class: 'UCDeployPublisher',
        siteName: '35.242.161.163',
        component: [
            $class: 'com.urbancode.jenkins.plugins.ucdeploy.VersionHelper$VersionBlock',
            componentName: 'Frontend Service Component',
         delivery: [
                $class: 'com.urbancode.jenkins.plugins.ucdeploy.DeliveryHelper$Push',
                pushVersion: '$componentName_${BUILD_NUMBER}',
                baseDir: '\\workspace\\web\\targets',
                fileIncludePatterns: '*.war',
                fileExcludePatterns: '',
                pushProperties: 'jenkins.server=Local\njenkins.reviewed=false',
                pushDescription: 'Pushed from Jenkins',
                pushIncremental: false
            ]
        ]
    ])
}
		stage('deploy to UcDeploy'){
			 step([$class: 'UCDeployPublisher',
        siteName: '35.242.161.163',
        component: [
            $class: 'com.urbancode.jenkins.plugins.ucdeploy.VersionHelper$VersionBlock',
            componentName: 'Frontend Service Component'
        ],
        deploy: [
            $class: 'com.urbancode.jenkins.plugins.ucdeploy.DeployHelper$DeployBlock',
            deployApp: 'Full Application',
            deployEnv: 'DEV',
            deployProc: 'Deploy Jenkins',
            deployVersions: '${component_name}_${BUILD_NUMBER}',
            deployOnlyChanged: false
        ]
    ])
}
	}
}
>>>>>>> 9f2f8450cfa8e1053d682697a9db376d9a75f061
